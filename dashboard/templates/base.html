<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{% block title %}Financial Data Dashboard{% endblock %}</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='css/style.css') }}">
    <script src="https://cdn.plot.ly/plotly-latest.min.js"></script>
</head>
<body>
    <nav class="navbar">
        <div class="container">
            <h1 class="logo">üìä Financial Data Dashboard</h1>
            <ul class="nav-links">
                <li><a href="{{ url_for('index') }}">Dashboard</a></li>
                <li><a href="{{ url_for('filings') }}">SEC Filings</a></li>
                <li><a href="{{ url_for('compare') }}">Compare</a></li>
                <li><a href="{{ url_for('add_ticker_page') }}">Add Ticker</a></li>
                <li>
                    <button id="darkModeToggle" class="theme-toggle" onclick="toggleDarkMode()">
                        <span class="sun-icon">‚òÄÔ∏è</span>
                        <span class="moon-icon">üåô</span>
                    </button>
                </li>
            </ul>
        </div>
    </nav>

    <div class="container">
        {% block content %}{% endblock %}
    </div>

    <footer>
        <p>Financial Data Aggregator ‚Ä¢ Star Schema Data Warehouse</p>
    </footer>

    <script>
        // Dark mode toggle functionality
        function toggleDarkMode() {
            document.body.classList.toggle('dark-mode');
            const isDark = document.body.classList.contains('dark-mode');
            localStorage.setItem('darkMode', isDark);
            updatePlotlyTheme();
        }

        // Load dark mode preference on page load
        document.addEventListener('DOMContentLoaded', function() {
            const darkMode = localStorage.getItem('darkMode');
            if (darkMode === 'true') {
                document.body.classList.add('dark-mode');
            }
            updatePlotlyTheme();
        });

        // Update Plotly chart themes
        function updatePlotlyTheme() {
            const isDark = document.body.classList.contains('dark-mode');
            const plots = document.querySelectorAll('.plotly-graph-div');
            
            plots.forEach(plot => {
                if (plot && plot.layout) {
                    const update = {
                        paper_bgcolor: isDark ? '#1e293b' : '#ffffff',
                        plot_bgcolor: isDark ? '#1e293b' : '#ffffff',
                        font: { color: isDark ? '#e2e8f0' : '#333333' },
                        xaxis: { 
                            gridcolor: isDark ? '#334155' : '#e5e7eb',
                            color: isDark ? '#e2e8f0' : '#333333'
                        },
                        yaxis: { 
                            gridcolor: isDark ? '#334155' : '#e5e7eb',
                            color: isDark ? '#e2e8f0' : '#333333'
                        }
                    };
                    Plotly.relayout(plot, update);
                }
            });
        }
    </script>
</body>
</html>
